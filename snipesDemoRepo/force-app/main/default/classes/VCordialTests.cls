@isTest
public class VCordialTests {
    public static final String TEST_JSON = '[{"_id":"60d6133d4f0bdb7c0343a60b","attributes":{"lastModified":"2022-11-01T14:43:38+0000","mdtLastSent":{"60ff11a6cc91d06971f2ff3c":"2021-09-08T18:23:06+00:00"},"last_login_time":"2021-07-21T13:34:27+00:00","last_purchase_date":"2022-10-31T04:00:00+00:00","last_visit_time":"2021-07-21T13:34:27+00:00","address":{"country":"United States of America","loc":{"lon":"-75.0198","lat":"40.1166"},"street_address":"2030 Byberry Rd","auto":false,"countryISO":"US","city":"Philadelphia","tz":"AmericaNew_York","state":"PA","postal_code":"19116-3016"},"createdAt":"2021-06-25T17:32:45+0000","lastUpdateSource":"api","days_since_last_purchase":1,"number_of_ecomm_orders":20,"total_in_store_orders":338,"number_of_all_orders":24,"number_of_in_store_orders":4,"aov":136.59416666666667,"total_ecomm_orders":2940.26,"total_all_orders":3278.26,"purchase_channels":"Omni-Channel","current_brand":"Snipes","gender":"undefined","sfcc_phone":"215-880-7992","brand_origin":"Snipes","last_name":"Test","source":"Checkout Subscribe","sfcc_customer_number":"M_00451534","first_name":"Jordan","retention":"No","lists":["Welcome"],"ID":"60d6133d4f0bdb7c0343a60b","cID":"60d6133d4f0bdb7c0343a60b"},"channels":{"email":{"address":"jordan.cohen@snipesusa.com","subscribeStatus":"subscribed","subscribedAt":"2021-06-25T17:32:45+00:00"}}},{"_id":"622281cb7fd02478031ef461","attributes":{"createdAt":"2022-03-04T21:16:59+0000","lastModified":"2022-11-01T14:23:07+0000","lastUpdateSource":"cordial","mdtLastSent":{"60ff11a6cc91d06971f2ff3c":"2022-03-04T21:17:06+00:00"},"source":"Account Signup Subscribe","lists":["Welcome"],"address":{"country":"United States","loc":{"lon":"-77.8361","lat":"38.6898"},"street_address":"","auto":true,"countryISO":"US","tz":"AmericaNew_York","state":"VA","postal_code":"20186"},"ID":"622281cb7fd02478031ef461","cID":"622281cb7fd02478031ef461"},"channels":{"email":{"address":"john.fiduccia@snipesusa.com","subscribeStatus":"subscribed","subscribedAt":"2022-03-04T21:17:04+00:00"}}},{"_id":"61ae5f694a3ed43f3015b195","attributes":{"createdAt":"2021-12-06T19:07:21+0000","lastModified":"2022-11-01T14:08:11+0000","lastUpdateSource":"cordial","mdtLastSent":{"60ff11a6cc91d06971f2ff3c":"2021-12-06T19:07:40+00:00"},"source":"Checkout Subscribe","lists":["Welcome"],"address":{"country":"United States","loc":{"lon":"-97.822","lat":"37.751"},"street_address":"","auto":true,"countryISO":"US","tz":"AmericaChicago","state":"","postal_code":""},"ID":"61ae5f694a3ed43f3015b195","cart":{"totalAmount":380,"lm":"2022-10-27T18:42:36+0000","cartitems":[{"images":[],"amount":180,"productID":"1797200027","qty":1,"name":"ACG Air Max Goadome Boots","description":"Array","itemPrice":180,"sku":"865031-009","category":"MAIN","attr":{"color":"865031-009","size":"9"},"url":"acg-air-max-goadome-boots-nike-black-865031-009"},{"images":[],"amount":200,"productID":"11552300039","qty":1,"name":"Air Jordan 3 Retro","description":"Array","itemPrice":200,"sku":"CT8532-105","category":"MAIN","attr":{"color":"CT8532-105","size":"13"},"url":"air-jordan-3-retro-jordan-white---dark-iris---cement-grey-ct8532-105"}]},"cID":"61ae5f694a3ed43f3015b195"},"channels":{"email":{"address":"brian.hinchey@snipesusa.com","subscribeStatus":"subscribed","subscribedAt":"2021-12-06T19:07:21+00:00"}}},{"_id":"6323771e28c77111be0ba4b4","attributes":{"createdAt":"2022-09-15T19:03:58+0000","lastModified":"2022-10-31T17:32:04+0000","lastUpdateSource":"api","number_of_ecomm_orders":0,"number_of_all_orders":2,"number_of_in_store_orders":2,"total_ecomm_orders":0,"total_all_orders":0,"purchase_channels":"In-Store","departmentAffinity":"Clothes","current_brand":"Snipes","brand_origin":"Snipes","brandAffinity":"Reebok","categoryAffinity":"Womens","last_name":"Mazzola","first_name":"Chase","retention":"No","ID":"6323771e28c77111be0ba4b4","cID":"6323771e28c77111be0ba4b4"},"channels":{"email":{"address":"chase.mazzola@veltig.com","subscribeStatus":"subscribed","subscribedAt":"2022-09-15T19:03:58+00:00"}}},{"_id":"635c8b07bc4f76c55900b63c","attributes":{"createdAt":"2022-10-29T02:08:07+0000","lastModified":"2022-10-29T02:08:07+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"917-863-5468","brand_origin":"Jimmy Jazz","last_name":"Padmore","first_name":"Dominic","retention":"No","address":{"country":"United States of America","loc":{"lon":"-73.638","lat":"40.6637"},"street_address":"421 yale ave","auto":false,"city":"Rockville Centre","countryISO":"US","tz":"AmericaNew_York","state":"NY","postal_code":"11570"},"ID":"635c8b07bc4f76c55900b63c","cID":"635c8b07bc4f76c55900b63c"},"channels":{"email":{"address":"dvp5067@gmail.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:08:07+00:00"}}},{"_id":"635c8b0691b0baca12077973","attributes":{"createdAt":"2022-10-29T02:08:06+0000","lastModified":"2022-10-29T02:08:06+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"+12522687730","brand_origin":"Jimmy Jazz","last_name":"Sutton","first_name":"James","retention":"No","address":{"country":"United States of America","loc":{"lon":"-77.6576","lat":"35.206"},"street_address":"3017 Englewood Drive3017 Englewood Drive, 3017 Englewood Dr","auto":false,"city":"Kinston","countryISO":"US","tz":"AmericaNew_York","state":"NC","postal_code":"28504"},"ID":"635c8b0691b0baca12077973","cID":"635c8b0691b0baca12077973"},"channels":{"email":{"address":"boogiesutton4@gmail.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:08:06+00:00"}}},{"_id":"635c8b0449f4a3a86209f693","attributes":{"createdAt":"2022-10-29T02:08:04+0000","lastModified":"2022-10-29T02:08:04+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"(603) 232-6641","brand_origin":"Jimmy Jazz","last_name":"marna","first_name":"maggio","retention":"No","address":{"country":"United States of America","loc":{"lon":"-71.4493","lat":"42.9656"},"street_address":"75 Faltin Dr","auto":false,"city":"Manchester","countryISO":"US","tz":"AmericaNew_York","state":"NH","postal_code":"03103"},"ID":"635c8b0449f4a3a86209f693","cID":"635c8b0449f4a3a86209f693"},"channels":{"email":{"address":"marnamaggio3@gmail.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:08:04+00:00"}}},{"_id":"635c8b0291b0baca1207796b","attributes":{"createdAt":"2022-10-29T02:08:02+0000","lastModified":"2022-10-29T02:08:02+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"8035661845","brand_origin":"Jimmy Jazz","last_name":"Jones","first_name":"Alfed","retention":"No","address":{"country":"United States of America","loc":{"lon":"-81.1632","lat":"32.1491"},"street_address":"15302 Reflection Way","auto":false,"city":"Port Wentworth","countryISO":"US","tz":"AmericaNew_York","state":"GA","postal_code":"31407"},"ID":"635c8b0291b0baca1207796b","cID":"635c8b0291b0baca1207796b"},"channels":{"email":{"address":"erica.mcdonald@yahoo.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:08:02+00:00"}}},{"_id":"635c8b0249f4a3a86209f68c","attributes":{"createdAt":"2022-10-29T02:08:02+0000","lastModified":"2022-10-29T02:08:02+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"3475450792","brand_origin":"Jimmy Jazz","last_name":"Klyuzov","first_name":"Maxim","retention":"No","address":{"country":"United States of America","loc":{"lon":"-73.4327","lat":"40.7315"},"street_address":"31 Alexander Ave","auto":false,"city":"Farmingdale","countryISO":"US","tz":"AmericaNew_York","state":"NY","postal_code":"11735"},"ID":"635c8b0249f4a3a86209f68c","cID":"635c8b0249f4a3a86209f68c"},"channels":{"email":{"address":"ben10klyuzov@gmail.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:08:02+00:00"}}},{"_id":"635c8b005f23dd6b6700c458","attributes":{"createdAt":"2022-10-29T02:08:00+0000","lastModified":"2022-10-29T02:08:00+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"3379626288","brand_origin":"Jimmy Jazz","last_name":"Simon","first_name":"Megan","retention":"No","address":{"country":"United States of America","loc":{"lon":"-89.7712","lat":"30.2784"},"street_address":"125 Palm Springs Drive","auto":false,"city":"Slidell","countryISO":"US","tz":"AmericaChicago","state":"LA","postal_code":"70458"},"ID":"635c8b005f23dd6b6700c458","cID":"635c8b005f23dd6b6700c458"},"channels":{"email":{"address":"megasimgeorge@yahoo.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:08:00+00:00"}}},{"_id":"635c8afef25db3d7ec06087f","attributes":{"createdAt":"2022-10-29T02:07:58+0000","lastModified":"2022-10-29T02:07:58+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"4193780120","brand_origin":"Jimmy Jazz","last_name":"Lyu","first_name":"Kexin","retention":"No","address":{"country":"United States of America","loc":{"lon":"-71.1027","lat":"42.3471"},"street_address":"1047 commonwealth ave.1047 commonwealth ave., apt.520","auto":false,"city":"Boston","countryISO":"US","tz":"AmericaNew_York","state":"MA","postal_code":"02215"},"ID":"635c8afef25db3d7ec06087f","cID":"635c8afef25db3d7ec06087f"},"channels":{"email":{"address":"cathy.052666@gmail.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:07:58+00:00"}}},{"_id":"635c8afdf860149009096af1","attributes":{"createdAt":"2022-10-29T02:07:57+0000","lastModified":"2022-10-29T02:07:57+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"(313) 348-5315","brand_origin":"Jimmy Jazz","last_name":"marshall","first_name":"laurea","retention":"No","address":{"country":"United States of America","loc":{"lon":"-83.2911","lat":"42.4969"},"street_address":"29154 Franklin Hills Drive, 29154 Franklin Hills Drive, , 210","auto":false,"city":"Southfield","countryISO":"US","tz":"AmericaDetroit","state":"MI","postal_code":"48034"},"ID":"635c8afdf860149009096af1","cID":"635c8afdf860149009096af1"},"channels":{"email":{"address":"laureamarshall@gmail.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:07:57+00:00"}}},{"_id":"635c8afb8960956f7303e7bb","attributes":{"createdAt":"2022-10-29T02:07:55+0000","lastModified":"2022-10-29T02:07:55+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"+19103822522","brand_origin":"Jimmy Jazz","last_name":"Herring","first_name":"Conrad","retention":"No","address":{"country":"United States of America","loc":{"lon":"-78.9354","lat":"34.9536"},"street_address":"5890 Corner Oaks Dr5890 Corner Oaks Dr, 5890 Corner Oaks Dr","auto":false,"city":"Hope Mills","countryISO":"US","tz":"AmericaNew_York","state":"NC","postal_code":"28348"},"ID":"635c8afb8960956f7303e7bb","cID":"635c8afb8960956f7303e7bb"},"channels":{"email":{"address":"crad52@gmail.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:07:55+00:00"}}},{"_id":"635c8afb3fdfd87b480adbb2","attributes":{"createdAt":"2022-10-29T02:07:55+0000","lastModified":"2022-10-29T02:07:55+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"+14125234377","brand_origin":"Jimmy Jazz","last_name":"Schaffner","first_name":"Nicole","retention":"No","address":{"country":"United States of America","loc":{"lon":"-79.8655","lat":"40.4346"},"street_address":"101 Watt Lane","auto":false,"city":"Pittsburgh","countryISO":"US","tz":"AmericaNew_York","state":"PA","postal_code":"15221"},"ID":"635c8afb3fdfd87b480adbb2","cID":"635c8afb3fdfd87b480adbb2"},"channels":{"email":{"address":"nicksboysthree@gmail.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:07:55+00:00"}}},{"_id":"635c8afa3fba75ef84086cba","attributes":{"createdAt":"2022-10-29T02:07:54+0000","lastModified":"2022-10-29T02:07:54+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"(804) 255-3119","brand_origin":"Jimmy Jazz","last_name":"Niyonsenga","first_name":"James","retention":"No","address":{"country":"United States of America","loc":{"lon":"-85.6953","lat":"38.1381"},"street_address":"5102 Gemma Way5102 Gemma Way, 203","auto":false,"city":"Louisville","countryISO":"US","tz":"AmericaKentuckyLouisville","state":"KY","postal_code":"40219"},"ID":"635c8afa3fba75ef84086cba","cID":"635c8afa3fba75ef84086cba"},"channels":{"email":{"address":"niyonsengaalpha24@gmail.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:07:54+00:00"}}},{"_id":"635c8af9b554fae4b70c9be9","attributes":{"createdAt":"2022-10-29T02:07:53+0000","lastModified":"2022-10-29T02:07:53+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"(515) 200-6018","brand_origin":"Jimmy Jazz","last_name":"Kiraba","first_name":"Jordan","retention":"No","address":{"country":"United States of America","loc":{"lon":"-91.5906","lat":"41.6937"},"street_address":"2101  14th Street","auto":false,"city":"Coralville","countryISO":"US","tz":"AmericaChicago","state":"IA","postal_code":"52241"},"ID":"635c8af9b554fae4b70c9be9","cID":"635c8af9b554fae4b70c9be9"},"channels":{"email":{"address":"mamayangu2@hotmail.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:07:53+00:00"}}},{"_id":"635c8af5992405f00f0e4719","attributes":{"createdAt":"2022-10-29T02:07:49+0000","lastModified":"2022-10-29T02:07:49+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"+13108741962","brand_origin":"Jimmy Jazz","last_name":"perrotta","first_name":"payton","retention":"No","address":{"country":"United States of America","loc":{"lon":"-118.4298","lat":"34.003"},"street_address":"12500 Culver Boulevard12500 Culver Boulevard, apt 306","auto":false,"city":"Los Angeles","countryISO":"US","tz":"AmericaLos_Angeles","state":"CA","postal_code":"90066"},"ID":"635c8af5992405f00f0e4719","cID":"635c8af5992405f00f0e4719"},"channels":{"email":{"address":"pperrotta3296@gmail.com","subscribeStatus":"unsubscribed","unsubscribedAt":"2022-10-29T02:07:49+0000"}}},{"_id":"635c8af4f382c63e0f0825fe","attributes":{"createdAt":"2022-10-29T02:07:48+0000","lastModified":"2022-10-29T02:07:48+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"(337) 458-9380","brand_origin":"Jimmy Jazz","last_name":"Mouton","first_name":"Vanessa","retention":"No","address":{"country":"United States of America","loc":{"lon":"-92.224","lat":"30.4013"},"street_address":"201 Annette St","auto":false,"city":"Church Point","countryISO":"US","tz":"AmericaChicago","state":"LA","postal_code":"70525"},"ID":"635c8af4f382c63e0f0825fe","cID":"635c8af4f382c63e0f0825fe"},"channels":{"email":{"address":"moutonvanessa98@yahoo.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:07:48+00:00"}}},{"_id":"635c8af0198a979852035af1","attributes":{"createdAt":"2022-10-29T02:07:44+0000","lastModified":"2022-10-29T02:07:44+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"5626397996","brand_origin":"Jimmy Jazz","last_name":"Rojo","first_name":"Ron","retention":"No","address":{"country":"United States of America","loc":{"lon":"-118.0883","lat":"33.9886"},"street_address":"7234 Cravell Ave","auto":false,"city":"Pico Rivera","countryISO":"US","tz":"AmericaLos_Angeles","state":"CA","postal_code":"90660"},"ID":"635c8af0198a979852035af1","cID":"635c8af0198a979852035af1"},"channels":{"email":{"address":"lethalron11@gmail.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:07:44+00:00"}}},{"_id":"635c8aef43396d4c98062cfa","attributes":{"createdAt":"2022-10-29T02:07:43+0000","lastModified":"2022-10-29T02:07:43+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"+17738127534","brand_origin":"Jimmy Jazz","last_name":"Donald","first_name":"Mauricia","retention":"No","address":{"country":"United States of America","loc":{"lon":"-87.6126","lat":"41.8196"},"street_address":"3550 South Rhodes Avenue3550 South Rhodes Avenue, 1906","auto":false,"city":"Chicago","countryISO":"US","tz":"AmericaChicago","state":"IL","postal_code":"60653"},"ID":"635c8aef43396d4c98062cfa","cID":"635c8aef43396d4c98062cfa"},"channels":{"email":{"address":"mauriciadonald19@gmail.com","subscribeStatus":"unsubscribed","unsubscribedAt":"2022-10-29T02:07:43+0000"}}},{"_id":"635c8aed47d6c0ca580071bf","attributes":{"createdAt":"2022-10-29T02:07:41+0000","lastModified":"2022-10-29T02:07:41+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"(860) 878-0993","brand_origin":"Jimmy Jazz","last_name":"Cassarino","first_name":"Bonnie","retention":"No","address":{"country":"United States of America","loc":{"lon":"-72.0579","lat":"41.3572"},"street_address":"156 Kings Highway","auto":false,"city":"Groton","countryISO":"US","tz":"AmericaNew_York","state":"CT","postal_code":"06340"},"ID":"635c8aed47d6c0ca580071bf","cID":"635c8aed47d6c0ca580071bf"},"channels":{"email":{"address":"bonjoe97@sbcglobal.net","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:07:41+00:00"}}},{"_id":"635c8aecf54b2acade0fbe94","attributes":{"createdAt":"2022-10-29T02:07:40+0000","lastModified":"2022-10-29T02:07:40+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"8044262625","brand_origin":"Jimmy Jazz","last_name":"Crawford","first_name":"Aexias","retention":"No","address":{"country":"United States of America","loc":{"lon":"-77.4788","lat":"37.4373"},"street_address":"5510 Belle Pond Drive","auto":false,"city":"Richmond","countryISO":"US","tz":"AmericaNew_York","state":"VA","postal_code":"23234"},"ID":"635c8aecf54b2acade0fbe94","cID":"635c8aecf54b2acade0fbe94"},"channels":{"email":{"address":"aswinson2015@yahoo.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:07:40+00:00"}}},{"_id":"635c8aeac472990297047b03","attributes":{"createdAt":"2022-10-29T02:07:38+0000","lastModified":"2022-10-29T02:07:38+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"(803) 650-9178","brand_origin":"Jimmy Jazz","last_name":"Harris","first_name":"Jonathan","retention":"No","address":{"country":"United States of America","loc":{"lon":"-80.8695","lat":"35.4011"},"street_address":"113 Whispering Pines Lane","auto":false,"city":"Huntersville","countryISO":"US","tz":"AmericaNew_York","state":"NC","postal_code":"28078"},"ID":"635c8aeac472990297047b03","cID":"635c8aeac472990297047b03"},"channels":{"email":{"address":"jonathanharris679@gmail.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:07:38+00:00"}}},{"_id":"635c8ae8b17c5776600cc7b9","attributes":{"createdAt":"2022-10-29T02:07:36+0000","lastModified":"2022-10-29T02:07:36+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"(718) 419-1976","brand_origin":"Jimmy Jazz","last_name":"Espada","first_name":"Jesus","retention":"No","address":{"country":"United States of America","loc":{"lon":"-74.1607","lat":"40.6301"},"street_address":"13 harbor rd, #213 harbor rd, #2, #2","auto":false,"city":"Staten Island","countryISO":"US","tz":"AmericaNew_York","state":"NY","postal_code":"10303"},"ID":"635c8ae8b17c5776600cc7b9","cID":"635c8ae8b17c5776600cc7b9"},"channels":{"email":{"address":"espadajesus1@gmail.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:07:36+00:00"}}},{"_id":"635c8ae65276ed3c5709ed99","attributes":{"createdAt":"2022-10-29T02:07:34+0000","lastModified":"2022-10-29T02:07:34+0000","lastUpdateSource":"api","number_of_all_orders":0,"total_all_orders":0,"purchase_channels":"No Purchases","current_brand":"Jimmy Jazz","sfcc_phone":"+1 225-281-5760","brand_origin":"Jimmy Jazz","last_name":"Banks","first_name":"Tiera","retention":"No","address":{"country":"United States of America","loc":{"lon":"-91.1167","lat":"30.5317"},"street_address":"13820 Sunshine Road","auto":false,"city":"Baton Rouge","countryISO":"US","tz":"AmericaChicago","state":"LA","postal_code":"70811"},"ID":"635c8ae65276ed3c5709ed99","cID":"635c8ae65276ed3c5709ed99"},"channels":{"email":{"address":"banks.tiera@yahoo.com","subscribeStatus":"subscribed","subscribedAt":"2022-10-29T02:07:34+00:00"}}}]';

    @isTest
    static void testCordialContactAPI() {
        Test.setMock(HttpCalloutMock.class, new ContactMock());
        VCordialContactsSchedule sched = new VCordialContactsSchedule();

        Test.startTest();
        sched.execute(null);
        Test.stopTest();

    }

    @isTest
    static void testCreatePA() {
        Account acc = new Account(
            FirstName = 'Test',
            LastName = 'Test',
            PersonEmail = 'test@test.com',
            BillingStreet = '123 St',
            BillingCity = 'City',
            BillingStateCode = 'CA',
            BillingCountryCode = 'US',
            BillingPostalCode = '92630'
        );

        Test.startTest();
        VAccountTriggerHandler.DISABLE_CORDIAL_UPDATE = false;
        insert acc;
        VAccountTriggerHandler.DISABLE_CORDIAL_UPDATE = false;
        update acc;
        Test.stopTest();
    }

    @isTest
    static void testOrders() {
        Account acc = new Account(FirstName = 'Test', LastName = 'Test', PersonEmail = 'test@test.com');
        insert acc;

        Order ord = new Order(EffectiveDate = Date.today(), AccountId = acc.Id, Status = 'Draft',
            Pricebook2Id = Test.getStandardPricebookId(),
            SentToCordial__c = false);
        insert ord;

        Product2 prod = new Product2(Name = 'Test', IsActive = true);
        insert prod;

        PricebookEntry pbEnt = new PricebookEntry(
            Pricebook2Id = Test.getStandardPricebookId(),
            Product2Id = prod.Id,
            UnitPrice = 100,
            IsActive = true
        );

        insert pbEnt;

        OrderItem ordItem = new OrderItem(
            OrderId = ord.Id,
            PricebookEntryId = pbEnt.Id,
            UnitPrice = 100,
            Quantity = 1
        );

        insert ordItem;

        Test.setMock(HttpCalloutMock.class, new SendOrderMock());

        Test.startTest();
        VCordialOrderBatch b = new VCordialOrderBatch();
        Database.executeBatch(b);
        Test.stopTest();
    }

    private class SendOrderMock implements HttpCalloutMock {
        public HttpResponse respond(HttpRequest req) {
            HttpResponse resp = new HttpResponse();
            resp.setStatusCode(200);

            return resp;
        }
    }

    private class CreateContactMock implements HttpCalloutMock {
        public HttpResponse respond(HttpRequest req) {
            HttpResponse resp = new HttpResponse();
            resp.setBody('{ "cID": "test"}');
            resp.setStatusCode(200);

            return resp;
        }
    }
    
    private class ContactMock implements HttpCalloutMock {
        public HttpResponse respond(HttpRequest req) {
            HttpResponse resp = new HttpResponse();
            resp.setBody(TEST_JSON);
            resp.setStatusCode(200);

            return resp;
        }
    }
}